
<!DOCTYPE html>
<html lang="en">

{% extends 'unid/navigationbar.html' %}
{% load static %}
{% block content %}


<head>
<link href="{% static 'unid/css/mypage.css' %}" rel="stylesheet">
<script src="{% static 'unid/vendor/jquery/jquery.js' %}"></script>
</head>


<body>
    {% if mypage.aaa %}
    <div id="myinfo" style="background: url('/{{ mypage.aaa }}'); background-size: cover;">
    {% else %}
    <div id="myinfo" style="color: ; background-size: cover;">
    {% endif %}
        <div style="text-align:center; position:relative; padding-left: 1010px;">
            <a id="edit_icon">
                <img style="color: ##525f82; width:28px; margin-top:40px; margin-bottom:0px; cursor: pointer; margin-right:40px;" src="{% static 'unid/icon/ui icons-28.png' %}">
            </a>
        </div>
        <div id="profile-icon" style="margin-top:-25px" >
            {% if request.session.user_image %}
            <div id="user_image_icon" style="text-align:center; padding-top:30px;">
                <img style="width:67px; height: 67px; border-radius:50%;" src="/{{ mypage.userimage }}">
            </div>
            {% else %}
            <div style="text-align:center; padding-top:30px;">
                <img style="width:67px; height: 67px;text-align: center;" src="{% static 'unid/icon/profle-icon.png' %}">
            </div>
            {% endif %}
        </div>
        <div id="user_profile">
            <div style="text-align: center; font-size: 25px; font-weight:500;width:100%; height:45%; margin-top: 10px;">{{ mypage.name }}</div>
            {% if mypage.profile %}
            <div style="text-align: center; margin-top: 13px; font-size:13px">{{ mypage.profile }}</div>
            {% else %}
            <div style="text-align: center; margin-top: 13px; font-size:13px">프로필을 등록해 주세요!</div>
            {% endif %}
        </div>
        <div id="user-info2">
            <div id="joining-date" style="width:118%;">
                <p style="text-align: center; display:inline;"><img style="width:20px;" src="{% static 'unid/icon/ui icons-29.png' %}"> {{ joining }}가입</p>
            </div>
            <div id="number-of-posts" style="width:125%;">
                <a href="#container" id="my_articles" data-tab="tab-1" style="color: white; cursor: pointer; text-align: center; display:inline; width:125%;"><img style="width:20px;" src="{% static 'unid/icon/ui icons-31.png' %}">{{ numbersOfArticles }}게시글</a>
            </div>
            <div id="number-of-contents" style="width:80%;">
                <a href="#container" id="my_contents" data-tab="tab-2" style="color: white; cursor: pointer; text-align: center; display:inline; width:125%;"><img style="width:20px;" src="{% static 'unid/icon/ui icons-30.png' %}">{{ numbersOfcontents }}콘텐츠</a>
            </div>
        </div>
    </div>


    {% if mypage.aaa %}
    <div id="myinfo_edit_mode" style="background-image: url('/{{ mypage.aaa }}'); background: rgba(0, 0, 0, 0.5)); background-size: cover;">
    {% else %}
    <div id="myinfo_edit_mode" style="color: ; background-size: cover; background: rgba(0, 0, 0, 0.5));">
    {% endif %}
        <div id="edit_icon_div" style="text-align:center; position: relative; padding-left:952px;">
            <a id="edit_icon" onclick="submitzzz();">
                <img style="color: ##525f82; width:83px; margin-top:40px; margin-bottom:0px; margin-right:40px; cursor: pointer;" src="{% static 'unid/icon/ui icons-33.png' %}">
            </a>
        </div>
        <form id="user_profile_edit_form" name="user_profile_edit_form" method="POST" enctype="multipart/form-data">
        {% csrf_token %}
            <div id="profile-icon_edit" style="margin-top:-23px; height: 100px; padding-top:30px;">
            {% if request.session.user_image %}
                <img id="img" style="width:67px; height: 67px; border-radius:50%;" src="/{{ mypage.userimage }}">
            {% else %}
                <img id="img" name="default_profile_img" style="width:67px; height: 67px;text-align: center; border-radius:50%;" src="{% static 'unid/icon/profle-icon.png' %}">
            {% endif %}
            </div>
            <div id="user_image_edit" style="width: 80px; position: relative; bottom: 75px; left: 49.8%;">
                <img class="a" src="{% static 'unid/icon/ui icons-32.png' %}" width="20" height="20" style="cursor:pointer;"/>
                <input class="aaa" id="user_image_upload" type="file" name="user_image_upload" style="cursor:pointer; width:20px; height:20px; position: relative; right: 24px; top: 5px;opacity: 0;" title="사진변경">
            </div>
            <div id="user_profile_edit">
                <div id="user_name_modifier" style="display: grid; grid-template-columns: 1fr 1fr; text-align: center;  width:400px; font-size: 25px; font-weight:500; margin: 0 auto; height: 40px; padding-left: 100px; margin-top: -19px;">
                    <input id="change_user_name" autocomplete="off" type="text" oninput="checkForm()" style="outline: none; color: white; text-shadow: 0.5px 0.5px 0.5px black; text-align: font-size: 25px; font-weight:500; center; border: 1px solid white; height:90%; background-color: transparent;" name="name" value="{{ mypage.name }}">
                    <div id="alert" style="width:300px; text-align:left; font-size:15px; color: #ed1b25; padding-top: 7px; padding-left: 15px;"></div>
                </div>
                <div id="user_profile_modifier" style="display: grid; grid-template-columns: 1fr 1fr; text-align: center; width:350px; margin: 0 auto; height: 28px; padding-left: 25px;margin-top: 4px; font-size:13px">
                    <input id="change_user_profile" autocomplete="off" type="text" name="profile" value="{{ mypage.profile }}" style="text-align:center; color: white; text-shadow: 0.5px 0.5px 0.5px black;; border:1px solid white; text-shadow: 0.5px 0.5px 0.1px black;background-color:transparent; height:100%; width: 300px;">
                    <div class="col_red" id="body_byte3" style="padding-top: 5px; padding-left: 15px;"></div>
                </div>
            </div>
            <div id="user-info2" class="edit_mode" style="margin-top: 9px;">
                <div id="joining-date" style="width:118%;">
                    <p style="text-align: center; display:inline;"><img style="width:20px;" src="{% static 'unid/icon/ui icons-29.png' %}"> {{ joining }}가입</p>
                </div>
                <div id="number-of-posts" style="width:125%;">
                    <p style="text-align: center; display:inline; width:125%;"><img style="width:20px;" src="{% static 'unid/icon/ui icons-31.png' %}">{{ numbersOfArticles }}게시글</p>
                </div>
                <div id="number-of-contents" style="width:80%;">
                    <p style="text-align: center; display:inline; width:80%;"><img style="width:20px;" src="{% static 'unid/icon/ui icons-30.png' %}">{{ numbersOfcontents }}콘텐츠</p>
                </div>
            </div>
            <div>
                <div id="edit_icon" style="text-align: center; position: relative; padding-left: 1010px; bottom: 30px;">
                    <img style="width:28px; cursor: pointer;" src="{% static 'unid/icon/ui icons-32.png' %}"/>
                    <input id="background" class="aaa" style="width: 29px; position: relative; right: 33px; opacity: 0; cursor: pointer;" type="file" name="background" title="배경사진등록">
                </div>
            </div>
        </form>
    </div>
    <div id="container">
        <ul class="tabs" id="tabs" style="margin-left:50px; margin-right:50px; padding-top:40px; font-size: 18px; font-weight: 500; border-bottom: 1px solid #c1c1c1; padding-bottom:5px;">
            <li class="tab-link current" id="my_act1" data-tab="tab-1">게시글</li> &nbsp&nbsp
            <li class="tab-link" id="my_act2" data-tab="tab-2" style="padding-left:15px;">콘텐츠</li> &nbsp&nbsp
            <li class="tab-link" id="my_act3" data-tab="tab-3" style="padding-left:21px;">콘텐츠거래</li> &nbsp&nbsp
            <li class="tab-link" id="my_act4" data-tab="tab-4" style="padding-left:10px;">보상</li>
            <li class="tab-link" id="my_act5" data-tab="tab-5" style="padding-left:10px;">분석</li>
            <div id="wallet">
                <a href="../mywallet" style="color:black;"><img style="width:30px;" src="{% static 'unid/icon/wallet-for-mypage.png' %}">지갑</a>
            </div>
        </ul>
        <div id="tab-1" class="tab-content current">
            <div id="content_column">
                <div id="title_of_contents" class="my_articles">내가 작성한 글</div>
                <div id="number_of_something">{{ numbersOfArticles }}건</div>
                    <br>
                    <br>
                    <br>
                {% if articles %}
                    {% for article in articles %}
                    <div class="popular-row">
                        <ul class="row-top">
                            {% if article.email.name == mypage.name %}
                            <a href="/unid/mypage">
                            {% else %}
                            <a href="{% url 'user_detail' article.email.IDX %}">
                            {% endif %}
                                <li>
                                    {% if article.email.userimage %}
                                    <img src="/{{ article.email.userimage }}">
                                    {% else %}
                                    <img src="{% static 'unid/icon/profle-icon.png' %}">
                                    {% endif %}
                                </li>
                                <li>
                                    {{ article.email.name }}
                                </li>
                            </a>
                            <li>
                                ·         {{ article.created_at|timesince }}전
                            </li>
                                <img src="/{{ article.category_path }}" width="64.7px" height="21.7px" />
                        </ul>
                        <div class="row-picture">
                            <a href="{% url 'main_detail' article.posts_id %}">
                                {% if article.image_path %}
                                    <img src="{{ article.image_path }}" width="99px" height="75px" style="border-radius: 3px; border: 1px solid #eaeaea;">
                                {% else %}
                                    <img src="/media/default.png" width="99px" height="75px" style="border-radius: 3px; border: 1px solid #eaeaea;">
                                {% endif %}
                            </a>
                        </div>
                        <ul class="row-middle">
                            <li>
                                <a href="{% url 'main_detail' article.posts_id %}">{{ article.title }}</a>
                            </li>
                            <li>
                                <a href="{% url 'main_detail' article.posts_id %}">{{ article.aaa|truncatechars_html:80 }}</a>
                            </li>
                        </ul>
                        <ul class="row-bottom">
                            <li>
                                <img src="{% static 'unid/icon/heart-icon.png' %}"> {{ article.like_count }}
                            </li>
                            <li>
                                <img src="{% static 'unid/icon/dollar-icon.png' %}"> {{ article.rewards }}
                            </li>
                            <li>
                                <img src="{% static 'unid/icon/wordballoon-icon.png' %}" width="25px" height="16.7px"> {{ article.rewards }}
                            </li>
                        </ul>
                    </div>
                    {% endfor %}
                    <input id="page" type="hidden" value="2">
                    {% if articles.paginator.count > 2 %}
                    <button id="callmorepost" class="form-control">
                    <i class="fas fa-chevron-down"></i>
                    </button>
                    {% endif %}
                {% else %}
                <div id="text_message">등록된 글이 없습니다. 글을 등록해보세요!</div>
                {% endif %}

            </div>
            <div id="content_column" style="min-height:250px;">
                <div id="title_of_contents">최근 댓글 내역</div>
                <div id="number_of_something">{{ numbersOfReply }}건</div>
                <br>
                <br>
                <br>
                {% if replies %}
                    {% for reply in replies %}
                    <div class="popular-row">
                        <ul class="row-top">
                            {% if reply.email.name == mypage.name %}
                            <a href="/unid/mypage">
                            {% else %}
                            <a href="{% url 'user_detail' reply.email.IDX %}">
                            {% endif %}
                                <li>
                                    {% if reply.email.userimage %}
                                    <img src="/{{ reply.email.userimage }}">
                                    {% else %}
                                    <img src="{% static 'unid/icon/profle-icon.png' %}">
                                    {% endif %}
                                </li>
                                <li>
                                    {{ reply.email.name }}
                                </li>
                            </a>
                            <li>
                                ·         {{ reply.posts_id.created_at|timesince }}전
                            </li>
                                <img src="{% static 'unid/icon/tag_schoolinfo.png' %}" width="64.7px" height="21.7px" >
                        </ul>
                        <div class="row-picture">
                            <a href="{% url 'main_detail' reply.posts_id_id %}">
                                {% if reply.posts_id.imagepath %}
                                    <img src="{{ article.imagepath }}" width="99px" height="75px" style="border-radius: 3px; border: 1px solid #eaeaea;">
                                {% else %}
                                    <img src="/media/default.png" width="99px" height="75px" style="border-radius: 3px; border: 1px solid #eaeaea;">
                                {% endif %}
                            </a>
                        </div>
                        <ul class="row-middle">
                            <li>
                                RE:&nbsp&nbsp<a href="{% url 'main_detail' reply.posts_id_id %}">{{ reply.posts_id.title }}</a>
                            </li>
                            <li>
                                <a href="{% url 'main_detail' reply.posts_id_id %}">{{ reply.replytext|truncatechars_html:80 }}</a>
                            </li>
                        </ul>
                        <ul class="row-bottom">
                            <li>
                                <span class="main-voting">
                                {% if user in info.like_user_set.all and info.rewards_success != "success" %}
                                <img src="{% static 'unid/icon/votingafter.png' %}" border="0" width="20" height="20"><span class="voting-count" id="votings"></span>

                                {% elif user not in info.like_user_set.all and info.rewards_success != "success" %}
                                <img src="{% static 'unid/icon/votingbefore.png' %}" border="0" width="20" height="20"><span class="voting-count" id="votings"></span>
                                {% else %}
                                <img src="{% static 'unid/icon/rewardafter.png' %}" border="0" width="20" height="20"><span class="voting-count" id="votings"></span>
                                {% endif %}
                                {{info.like_count}}
                            </span>
                            </li>
                            <li>
                                <img src="{% static 'unid/icon/heart-icon.png' %}"> {{ reply.posts_id.rewards }}
                            </li>
                            <li>
                                <img src="{% static 'unid/icon/wordballoon-icon.png' %}" width="25px" height="16.7px"> {{ reply.posts_id.rewards }}
                            </li>
                        </ul>
                    </div>
                    {% endfor %}
                {% else %}
                <div id="text_message">등록된 댓글이 없습니다. 글을 등록해보세요!</div>
                {% endif %}
            </div>
        </div>
        <div id="tab-2" class="tab-content" >
            <div id="content_column" class="content_column" style="min-height:250px;" name="zzz">
                <div id="title_of_contents">내가 올린 콘텐츠</div>
                <div id="number_of_something">{{ numbersOfcontents }}건</div>
                <br>
                <br>
                <br>
                {% if contentsboard %}
                    {% for content in contentsboard %}
                    <div class="popular-row" >
                        <ul class="row-top">
                            {% if content.writeremail.name == mypage.name %}
                            <a href="/unid/mypage">
                            {% else %}
                            <a href="{% url 'user_detail' content.writeremail.IDX %}">
                            {% endif %}
                                <li>
                                    {% if content.writeremail.userimage %}
                                    <img src="/{{ content.writeremail.userimage }}">
                                    {% else %}
                                    <img src="{% static 'unid/icon/profle-icon.png' %}">
                                    {% endif %}
                                </li>
                                <li>
                                    {{ content.writeremail.name }}
                                </li>
                            </a>
                            <li>
                                ·         {{ content.created|timesince }}전
                            </li>
                            <img src="/{{ content.cagegory_path }}" width="64.7px" height="21.7px" >
                        </ul>
                        <div class="row-picture">
                            <a href="{% url 'contentsdetail' content.contents_id %}">
                                {% if content.imagepath %}
                                    <img src="/{{ content.imagepath }}" width="99px" height="75px" style="border-radius: 3px; border: 1px solid #eaeaea;">
                                {% else %}
                                    <img src="/media/default.png" width="99px" height="75px" style="border-radius: 3px; border: 1px solid #eaeaea;">
                                {% endif %}
                            </a>
                        </div>
                        <ul class="row-middle">
                            <li>
                                <a href="{% url 'contentsdetail' content.contents_id %}">{{ content.title }}</a>
                            </li>
                            <li>
                                <a href="{% url 'contentsdetail' content.contents_id %}">{{ content.contents|truncatechars_html:80 }}</a>
                            </li>
                        </ul>
                        <ul class="row-bottom">
                            <li>
                                <img src="{% static 'unid/icon/dollar-icon.png' %}"> {{ content.price }}
                            </li>
                            <li>
                                <img src="{% static 'unid/icon/wordballoon-icon.png' %}" width="25px" height="16.7px"> {{ content.replymentcount }}
                            </li>
                        </ul>
                    </div>
                    {% endfor %}
                {% else %}
                <div id="text_message">등록된 콘텐츠가 없습니다. 콘텐츠을 등록해보세요!</div>
                {% endif %}
            </div>
            <div id="content_column" style="min-height:250px;">
                <div id="title_of_contents">내가 받은 콘텐츠</div>
                <div id="number_of_something">{{ numbersOfDownloads }}건</div>
                <br>
                <br>
                <br>
                {% if downloads %}
                    {% for download in downloads %}
                    <div class="popular-row">
                        <ul class="row-top">
                            {% if download.contents_id.writeremail.name == mypage.name %}
                            <a href="/unid/mypage">
                            {% else %}
                            <a href="{% url 'user_detail' download.contents_id.writeremail.IDX %}">
                            {% endif %}
                                <li>
                                    {% if download.contents_id.writeremail.userimage %}
                                    <img src="/{{ download.contents_id.writeremail.userimage }}">
                                    {% else %}
                                    <img src="{% static 'unid/icon/profle-icon.png' %}">
                                    {% endif %}
                                </li>
                                <li>
                                    {{ download.contents_id.writeremail.name }}
                                </li>
                            </a>
                            <li>
                                ·         {{ download.contents_id.created|timesince }}전
                            </li>
                            <img src="/{{ download.contents_id.cagegory_path }}" width="64.7px" height="21.7px" >
                        </ul>
                        <div class="row-picture">
                            <a href="{% url 'contentsdetail' download.contents_id.contents_id %}">
                                {% if download.contents_id.imagepath %}
                                    <img src="/{{ download.contents_id.imagepath }}" width="99px" height="75px" style="border-radius: 3px; border: 1px solid #eaeaea;">
                                {% else %}
                                    <img src="/media/default.png" width="99px" height="75px" style="border-radius: 3px; border: 1px solid #eaeaea;">
                                {% endif %}
                            </a>
                        </div>
                        <ul class="row-middle">
                            <li>
                                <a href="{% url 'contentsdetail' download.contents_id.contents_id %}">{{ download.contents_id.title }}</a>
                            </li>
                            <li>
                                <a href="{% url 'contentsdetail' download.contents_id.contents_id %}">{{ download.contents_id.contents|truncatechars_html:80 }}</a>
                            </li>
                        </ul>
                        <ul class="row-bottom">
                            <li>
                                <img src="{% static 'unid/icon/dollar-icon.png' %}"> {{ download.contents_id.price }}
                            </li>
                            <li>
                                <img src="{% static 'unid/icon/wordballoon-icon.png' %}" width="25px" height="16.7px"> {{ download.contents_id.replymentcount }}
                            </li>
                        </ul>
                    </div>
                    {% endfor %}
                {% else %}
                <div id="text_message">다운로드한 콘텐츠가 없습니다. 콘텐츠을 구매해보세요!</div>
                {% endif %}
            </div>
        </div>
        <div id="tab-3" class="tab-content">
            <div id="content_column" style="margin-left: 50px; min-height:250px;">
                <div id="title_of_contents" style="margin-bottom:30px;">콘텐츠 판매 내역</div>
                <div id="number_of_something">{{ numbersOfsell }}건</div>
                <div id="number_of_something" style="font-size:16px; width:300px; font-weight:400; position: relative; left: 586px;">합계:
                    <span style="color: #2fcc71;"><img src="{% static 'unid/icon/dollar-icon.png' %}" border="0" width="18" height="18" style="margin-bottom:3px; margin-left:10px; margin-right:5px;">{{ totalForContentsSelling }}</span>
                </div>
                <br>
                <br>
                <br>
                {% if contents_transfer %}
                    <div class="row_for_table" style="width:95%; ">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th scope="col" id="col" style="width:140px;">승인날짜</th>
                                    <th scope="col" id="col" style="width:450px;">콘텐츠</th>
                                    <th scope="col" id="col" style="width:140px;">저자</th>
                                    <th scope="col" id="col" style="">금액</th>
                                </tr>
                            </thead>
                            {% for content_transfer in contents_transfer %}
                            <tbody>
                                <tr>
                                    <th scope="row" style="text-align: center; font-size:13.1px; font-weight: 400;"> {{ content_transfer.transactiondate }}</th>
                                    <td style="text-align: center; font-size:16px; font-weight:500;"><a href="{% url 'contentsdetail' content_transfer.contents_id.contents_id %}">{{ content_transfer.contents_id.title }}</a></td>
                                    {% if content_transfer.toAccount.name == mypage.name %}
                                    <td style="text-align: center;"><a href="/unid/mypage">{{ content_transfer.toAccount.name }}</a></td>
                                    {% else %}
                                    <td style="text-align: center;"><a href="{% url 'user_detail' content_transfer.toAccount.IDX %}">{{ content_transfer.toAccount.name }}</a></td>
                                    {% endif %}
                                    <td style="text-align: center;"><img src="{% static 'unid/icon/dollar-icon.png' %}" border="0" width="18" height="18"> {{ content_transfer.balance }}</td>
                                </tr>
                            </tbody>
                            {% endfor %}
                        </table>
                    </div>
                {% else%}
                    <div id="text_message">아직 판매한 콘텐츠가 없습니다.</div>
                {% endif %}
            </div>
            <div id="content_column" style="margin-left: 50px; min-height:250px; font-family: 'Noto Sans KR', sans-serif;">
                <div id="title_of_contents" style="margin-bottom:30px;">콘텐츠 구매 내역</div>
                <div id="number_of_something">{{ numbersOfbuy }}건</div>
                <br>
                <br>
                <br>
                {% if contents_transfer_sell %}
                    <div class="row_for_table" style="width:95%; font-family: 'Noto Sans KR', sans-serif;">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th scope="col" id="col" style="width:140px;">승인날짜</th>
                                    <th scope="col" id="col" style="width:450px;">콘텐츠</th>
                                    <th scope="col" id="col" style="width:140px;">저자</th>
                                    <th scope="col" id="col" style="">금액</th>
                                </tr>
                            </thead>
                            {% for content_transfer_sell in contents_transfer_sell %}
                            <tbody>
                                <tr>
                                    <th scope="row" style="text-align: center; font-size:13.1px; font-weight: 400;"> {{ content_transfer_sell.transactiondate }}</th>
                                    <td style="text-align: center;font-size:16px; font-weight:500;"><a href="{% url 'contentsdetail' content_transfer_sell.contents_id.contents_id %}">{{ content_transfer_sell.contents_id.title }}</a></td>
                                    {% if content_transfer_sell.toAccount.name == mypage.name %}
                                    <td style="text-align: center;"><a href="/unid/mypage">{{ content_transfer_sell.toAccount.name }}</a></td>
                                    {% else %}
                                    <td style="text-align: center;"><a href="{% url 'user_detail' content_transfer_sell.toAccount.IDX %}">{{ content_transfer_sell.toAccount.name }}</a></td>
                                    {% endif %}
                                    <td style="text-align: center;"><img src="{% static 'unid/icon/dollar-icon.png' %}" border="0" width="18" height="18"> {{ content_transfer_sell.balance }}</td>
                                </tr>
                            </tbody>
                            {% endfor %}
                        </table>
                    </div>
                {% else %}
                    <div id="text_message">아직 구매한 콘텐츠가 없습니다.</div>
                {% endif %}
            </div>
        </div>
        <div id="tab-4" class="tab-content">
            <div id="content_column" style="font-family: 'Noto Sans KR', sans-serif;">
                {% if rewardedArticles %}

                <div id="title_of_contents" style="margin-bottom:30px;">정보공유 보상 내역</div>
                <div id="number_of_something" style="padding-left: 25px;">{{ numbersOfrewardedArticles }}건</div>
                <div id="number_of_something" style="font-size:16px; width:300px; font-weight:400; position: relative; left: 600px; margin-left:-55px;">
                    <div id="cal_for_rewards" style="color: #2fcc71;"><span style="color:darkgray">보상금액:</span>  <img src="{% static 'unid/icon/dollar-icon.png' %}" border="0" width="18" height="18" style="margin-bottom:3px;margin-left:10px; margin-right:5px;">{{ totalRewards }}</div>
                    <div id="will_reward" style="color: #f1c40f;"><span style="color:darkgray">예정금액:</span>  <img src="{% static 'unid/icon/dollar-icon.png' %}" border="0" width="18" height="18" style="margin-bottom:3px; margin-left:10px; margin-right:5px;">{{ willReward }}</div>
                </div>
                <br>
                <br>
                <br>
                <div class="row_for_table" style="width:95%; font-family: 'Noto Sans KR', sans-serif;">
                    <table class="table">
                        <thead>
                            <tr style="font-family: 'Noto Sans KR', sans-serif;">
                                <th scope="col" id="col" style="width:140px;">게시일</th>
                                <th scope="col" id="col" style="width:140px;">보상예정일</th>
                                <th scope="col" id="col" style="width:150px">금액</th>
                                <th scope="col" id="col" style="">게시글</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for rewardedArticle in rewardedArticles %}
                                {% if rewardedArticle.rewards != 0 %}
                                <tr>
                                    <th scope="row" style="text-align: center; font-size:13.1px; font-weight: 400;"> {{ rewardedArticle.created_at }}</th>
                                    {% if rewardedArticle.rewards_success %}
                                        <td style="text-align: center; font-weight:400;">
                                            <img src="{% static 'unid/icon/success.png' %}" border="0" width="20" height="20" style="margin-bottom: 3px; margin-right: 5px; font-size:15px;">완료
                                        </td>
                                    {% else %}
                                        <th scope="row" style="text-align: center; font-size:13.1px; font-weight: 400;"> {{ rewardedArticle.reward_date }}</th>
                                    {% endif %}
                                    <td id="calculate" style="text-align: center;"><img src="{% static 'unid/icon/dollar-icon.png' %}" border="0" width="18" height="18" style="margin-bottom:3px; margin-left:10px; margin-right:5px;">{{ rewardedArticle.bbb }}</td>
                                    <a href="{% url 'main_detail' rewardedArticle.posts_id %}">
                                        <td style="text-align: center;font-size:16px; font-weight:500;"><a href="{% url 'main_detail' rewardedArticle.posts_id %}">{{ rewardedArticle.title }}</a></td>
                                    </a>
                                </tr>
                                {% endif %}
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div id="title_of_contents" style="margin-bottom:30px;">정보공유 보상 내역</div>
                <div id="number_of_something" style="padding-left: 25px;"> 0 건</div>
                <br>
                <br>
                <br>
                <div id="text_message">정보공유 보상내역이 없습니다. 정보공유 게시판에 글을 작성하고 보상을 받으세요!</div>
                {% endif %}
            </div>
            <br>
            <div id="content_column" style="font-family: 'Noto Sans KR', sans-serif;">
                <div id="title_of_contents" style="margin-bottom:30px;">보팅 보상 내역</div>
                <div id="number_of_something">{{ numbersOfLike }}건</div>
                <div id="number_of_something" style="font-size:16px; width:300px; font-weight:400; position: relative; left: 600px; margin-left:-55px;">
                    <div id="cal_for_rewards" style="color: #2fcc71;"><span style="color:darkgray">보상금액:</span>  <img src="{% static 'unid/icon/dollar-icon.png' %}" style="margin-bottom:3px; margin-left:10px; margin-right:5px;" border="0" width="18" height="18">{{ totalRewardsForLikes }}</div>
                    <div id="will_reward" style="color: #f1c40f;"><span style="color:darkgray">예정금액:</span>  <img src="{% static 'unid/icon/dollar-icon.png' %}" style="margin-bottom:3px; margin-left:10px; margin-right:5px;" border="0" width="18" height="18">{{ willRewardForLikes }}</div>
                </div>
                <br>
                <br>
                <br>
                {% if likeusers %}
                <div class="row_for_table" style="width:95%; ">
                    <table class="table">
                        <thead>
                            <tr style="font-family: 'Noto Sans KR', sans-serif;">
                                <th scope="col" id="col" style="width:140px;">게시일</th>
                                <th scope="col" id="col" style="width:140px;">보상예정일</th>
                                <th scope="col" id="col" style="width:150px">금액</th>
                                <th scope="col" id="col" style="">게시글</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for like in likeusers %}
                            <tr>
                                <th scope="row" style="text-align: center; font-size:13.1px; font-weight: 400;"> {{ like.created_at }}</th>
                                {% if like.rewards_success %}
                                    <td style="text-align: center; font-weight:400; font-family: 'Noto Sans KR', sans-serif;"><img src="{% static 'unid/icon/success.png' %}" border="0" width="20" height="20" style="margin-bottom: 3px; margin-right: 5px;font-size:15px;">완료</td>
                                {% else %}
                                    <td style="text-align: center; font-weight:400; font-size:13.1px; font-family: 'Noto Sans KR', sans-serif;">{{ like.posts_id.reward_date }}</td>
                                {% endif %}
                                <td style="text-align: center;font-family: 'Noto Sans KR', sans-serif;"><img src="{% static 'unid/icon/dollar-icon.png' %}" border="0" width="18" height="18" style="margin-bottom:3px; margin-left:10px; margin-right:5px;"> 0.02 </td>
                                <td style="text-align: center;font-family: 'Noto Sans KR', sans-serif;font-size:16px; font-weight:500;"><a href="{% url 'main_detail' like.posts_id.posts_id %}">{{ like.posts_id.title }}</a></td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div id="text_message">보팅내역이 없습니다. 정보공유 게시글에 보팅하고 보상을 받으세요!</div>
                {% endif %}
            </div>
        </div>
        <div id="tab-5" class="tab-content">
            <div style="text-align: center;    position: relative; bottom: -66px; z-index: 1;"><p><h3>월별 니드토큰 이용 내역</h3></p></div>
            <div id="chart_div" style="width: 900px; height: 500px;"></div>
            <div id="content_column" style="font-family: 'Noto Sans KR', sans-serif;">
                {% if rewardedArticles %}

                <div id="title_of_contents" style="margin-bottom:30px;">정보공유 보상 내역</div>
                <div id="number_of_something" style="padding-left: 25px;">{{ numbersOfrewardedArticles }}건</div>
                <div id="number_of_something" style="font-size:16px; width:300px; font-weight:400; position: relative; left: 600px; margin-left:-55px;">
                    <div id="cal_for_rewards" style="color: #2fcc71;"><span style="color:darkgray">보상금액:</span>  <img src="{% static 'unid/icon/dollar-icon.png' %}" border="0" width="18" height="18" style="margin-bottom:3px;margin-left:10px; margin-right:5px;">{{ totalRewards }}</div>
                    <div id="will_reward" style="color: #f1c40f;"><span style="color:darkgray">예정금액:</span>  <img src="{% static 'unid/icon/dollar-icon.png' %}" border="0" width="18" height="18" style="margin-bottom:3px; margin-left:10px; margin-right:5px;">{{ willReward }}</div>
                </div>
                <br>
                <br>
                <br>
                <div class="row_for_table" style="width:95%; font-family: 'Noto Sans KR', sans-serif;">
                    <table class="table">
                        <thead>
                            <tr style="font-family: 'Noto Sans KR', sans-serif;">
                                <th scope="col" id="col" style="width:140px;">게시일</th>
                                <th scope="col" id="col" style="width:140px;">보상예정일</th>
                                <th scope="col" id="col" style="width:150px">금액</th>
                                <th scope="col" id="col" style="">게시글</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for rewardedArticle in rewardedArticles %}
                                {% if rewardedArticle.rewards != 0 %}
                                <tr>
                                    <th scope="row" style="text-align: center; font-size:13.1px; font-weight: 400;"> {{ rewardedArticle.created_at }}</th>
                                    {% if rewardedArticle.rewards_success %}
                                        <td style="text-align: center; font-weight:400;">
                                            <img src="{% static 'unid/icon/success.png' %}" border="0" width="20" height="20" style="margin-bottom: 3px; margin-right: 5px; font-size:15px;">완료
                                        </td>
                                    {% else %}
                                        <th scope="row" style="text-align: center; font-size:13.1px; font-weight: 400;"> {{ rewardedArticle.reward_date }}</th>
                                    {% endif %}
                                    <td id="calculate" style="text-align: center;"><img src="{% static 'unid/icon/dollar-icon.png' %}" border="0" width="18" height="18" style="margin-bottom:3px; margin-left:10px; margin-right:5px;">{{ rewardedArticle.bbb }}</td>
                                    <a href="{% url 'main_detail' rewardedArticle.posts_id %}">
                                        <td style="text-align: center;font-size:16px; font-weight:500;"><a href="{% url 'main_detail' rewardedArticle.posts_id %}">{{ rewardedArticle.title }}</a></td>
                                    </a>
                                </tr>
                                {% endif %}
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div id="title_of_contents" style="margin-bottom:30px;">정보공유 보상 내역</div>
                <div id="number_of_something" style="padding-left: 25px;"> 0 건</div>
                <br>
                <br>
                <br>
                <div id="text_message">정보공유 보상내역이 없습니다. 정보공유 게시판에 글을 작성하고 보상을 받으세요!</div>
                {% endif %}
            </div>
            <br>
            <div id="content_column" style="font-family: 'Noto Sans KR', sans-serif;">
                <div id="title_of_contents" style="margin-bottom:30px;">보팅 보상 내역</div>
                <div id="number_of_something4" class="ddddd">{{ numbersOfLike }}건</div>
                <div id="number_of_something" style="font-size:16px; width:300px; font-weight:400; position: relative; left: 600px; margin-left:-55px;">
                    <div id="cal_for_rewards" style="color: #2fcc71;"><span style="color:darkgray">보상금액:</span>  <img src="{% static 'unid/icon/dollar-icon.png' %}" style="margin-bottom:3px; margin-left:10px; margin-right:5px;" border="0" width="18" height="18">{{ totalRewardsForLikes }}</div>
                    <div id="will_reward" style="color: #f1c40f;"><span style="color:darkgray">예정금액:</span>  <img src="{% static 'unid/icon/dollar-icon.png' %}" style="margin-bottom:3px; margin-left:10px; margin-right:5px;" border="0" width="18" height="18">{{ willRewardForLikes }}</div>
                </div>
                <br>
                <br>
                <br>
                {% if likeusers %}
                <div class="row_for_table" style="width:95%; ">
                    <table class="table">
                        <thead>
                            <tr style="font-family: 'Noto Sans KR', sans-serif;">
                                <th scope="col" id="col" style="width:140px;">게시일</th>
                                <th scope="col" id="col" style="width:140px;">보상예정일</th>
                                <th scope="col" id="col" style="width:150px">금액</th>
                                <th scope="col" id="col" style="">게시글</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for like in likeusers %}
                            <tr>
                                <th scope="row" style="text-align: center; font-size:13.1px; font-weight: 400;"> {{ like.created_at }}</th>
                                {% if like.rewards_success %}
                                    <td style="text-align: center; font-weight:400; font-family: 'Noto Sans KR', sans-serif;"><img src="{% static 'unid/icon/success.png' %}" border="0" width="20" height="20" style="margin-bottom: 3px; margin-right: 5px;font-size:15px;">완료</td>
                                {% else %}
                                    <td style="text-align: center; font-weight:400; font-size:13.1px; font-family: 'Noto Sans KR', sans-serif;">{{ like.posts_id.reward_date }}</td>
                                {% endif %}
                                <td style="text-align: center;font-family: 'Noto Sans KR', sans-serif;"><img src="{% static 'unid/icon/dollar-icon.png' %}" border="0" width="18" height="18" style="margin-bottom:3px; margin-left:10px; margin-right:5px;"> 0.02 </td>
                                <td style="text-align: center;font-family: 'Noto Sans KR', sans-serif;font-size:16px; font-weight:500;"><a href="{% url 'main_detail' like.posts_id.posts_id %}">{{ like.posts_id.title }}</a></td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div id="text_message">보팅내역이 없습니다. 정보공유 게시글에 보팅하고 보상을 받으세요!</div>
                {% endif %}
            </div>
        </div>
    </div>
</body>
<script src="http://code.jquery.com/jquery-3.1.1.min.js"></script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script>
	// 차트를 사용하기 위한 준비입니다.
	google.charts.load('current', {packages:['corechart']});
</script>
<script src="http://code.jquery.com/jquery-latest.min.js"></script>
<script src="http://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script>



    function checkForm() {
        var form = document.getElementById("change_user_name").value;
        var nickname = document.user_profile_edit_form.name;

        if (!form){
            document.getElementById("change_user_name").style.border="2px solid #ed1b25";
            document.getElementById("alert").innerHTML="닉네임을 입력하세요";
            document.getElementById("alert").style.color="#ed1b25";
            return false;
        }
        else{
            document.getElementById("change_user_name").style.border="2px solid green";
            document.getElementById("alert").innerHTML="사용가능";
            document.getElementById("alert").style.color="green";
        }

        var special_pattern = /[`~!@#$%^&*|\\\'\";:\/?]/gi;
        if(special_pattern.test(form) == true){
            document.getElementById("change_user_name").style.border="2px solid #ed1b25";
            document.getElementById("alert").innerHTML="특수문자는 사용할 수 없습니다.";
            console.log(document.getElementById("alert").innerHTML);
            document.getElementById("alert").style.color="#ed1b25";
            return false;
        }
        else{
            document.getElementById("change_user_name").style.border="2px solid green";
            document.getElementById("alert").innerHTML="사용가능";
            document.getElementById("alert").style.color="green";
        }

        var blank_pattern2 = /[\s]/g;
        if(blank_pattern2.test(form) == true){
            document.getElementById("change_user_name").style.border="2px solid #ed1b25";
            document.getElementById("alert").innerHTML="공백은 사용하실 수 없습니다.";
            document.getElementById("alert").style.color="#ed1b25";
            return false;
        }
        else{
            document.getElementById("change_user_name").style.border="2px solid green";
            document.getElementById("alert").innerHTML="사용가능";
            document.getElementById("alert").style.color="green";
        }

        var blank_pattern = /^\s+|\s+$/g;
        if(form.replace( blank_pattern,'') == ""){
            document.getElementById("change_user_name").style.border="2px solid #ed1b25";
            document.getElementById("alert").innerHTML="공백은 사용하실 수 없습니다.";
            document.getElementById("alert").style.color="#ed1b25";
            return false;
        }
        else{
            document.getElementById("change_user_name").style.border="2px solid green";
            document.getElementById("alert").innerHTML="사용가능";
            document.getElementById("alert").style.color="green";
        }
    }

    function submitzzz() {
        var k = document.getElementById("alert");
        if (k.innerHTML == "닉네임중복"){
            alert("닉네임중복");
            return false;
        }

        if (checkForm() == false) {
            alert("닉네임을 입력하세요");
            return false;
        }


        document.getElementById('user_profile_edit_form').submit();
    }












    jQuery(document).ready(function($){
        $('ul.tabs li').click(function(){
            var tab_id = $(this).attr('data-tab');
            $('ul.tabs li').removeClass('current');
            $('.tab-content').removeClass('current');


            $(this).addClass('current');
            $("#"+tab_id).addClass('current');
        });


        $('p#my_articles').click(function(){
            var tab_id = $(this).attr('data-tab');
            $('ul.tabs li').removeClass('current');
            $('.tab-content').removeClass('current');


            $(this).addClass('current');
            $("#"+tab_id).addClass('current');
        });

        $('p#my_contents').click(function(){
            var tab_id = $(this).attr('data-tab');
            $('ul.tabs li').removeClass('current');
            $('.tab-content').removeClass('current');


            $(this).addClass('current');
            $("#"+tab_id).addClass('current');
        });


        $('#edit_icon').on('click', function(){
            $('#myinfo').hide();
            $('#myinfo_edit_mode').show();
        });

        $('#myinfo_edit_mode').keyup(function(e) {
            if ( e.keyCode == 27) {
                $('#myinfo_edit_mode').hide();
                $('#myinfo').show();
            }
        });



        $("#change_user_name").on('keyup', function() {

            //userid 를 param.
            var user_name =  $("#change_user_name").val();
            var duplicated = "닉네임중복";
            var alert1 = "사용가능";
            var alert2 = "닉네임을 입력해주세요";
            $.ajax({
                type : 'POST',
                data : { name: user_name },
                cache : false,
                url: "../user_name_verification/",
                success : function(res) {
                    if (res.Ans == 1) {
                        $("#alert").html(duplicated);
                        $("#alert").css("color","#ed1b25");
                        $("#change_user_name").css("border", "2px solid #ed1b25")
                        $("#change_user_name").focus()
                    };
                }
            });
        });



        $('#change_user_name').on('keyup', function(){
            // 남은 글자 수를 구한다.
            var strValue = $(this).val();
            var strLen = strValue.length;
            //console.log(strLen);
            var totalByte = 0;

            var len = 0;
            var oneChar = "";
            var str2 = "";

            for (var i = 0; i < strLen; i++) {
                oneChar = strValue.charAt(i);
                if (escape(oneChar).length > 4) {
                    totalByte += 2;
                }
                else {
                    totalByte++;
                }
            }
            //console.log(totalByte);
            // 넘어가는 글자는 자른다.
            if (totalByte > 10) {
                alert(10 + "자를 초과 입력 할 수 없습니다.");
                str2 = strValue.substr(0, 10);
                $('#change_user_name').val(str2);
            }
        });

        $('#change_user_profile').on('keyup', function(){
            // 남은 글자 수를 구한다.
            var strValue = $(this).val();
            var strLen = strValue.length;
            //console.log(strLen);
            var totalByte = 0;

            var len = 0;
            var oneChar = "";
            var str2 = "";

            for (var i = 0; i < strLen; i++) {
                oneChar = strValue.charAt(i);
                if (escape(oneChar).length > 4) {
                    totalByte += 2;
                }
                else {
                    totalByte++;
                }
                $('#body_byte3').html(totalByte + "/100");
            }
            //console.log(totalByte);
            // 넘어가는 글자는 자른다.
            if (totalByte > 100) {
                alert(100 + "자를 초과 입력 할 수 없습니다.");
                str2 = strValue.substr(0, 100);
                $('#change_user_profile').val(str2);
            }
        });
        $('#number-of-contents').on('click', function() {
            if ( !$('#my_act2').hasClass('current') ){
                $('#my_act1').removeClass('current');
                $('#my_act3').removeClass('current');
                $('#my_act2').addClass('current');
                $('#tab-3').removeClass('current');
                $('#tab-1').removeClass('current');
                $('#tab-2').addClass('current');
                $('.content_column').scrollIntoView();
            }
        });
        $('#number-of-posts').on('click', function() {
            if ( !$('#my_act1').hasClass('current') ){
                $('#my_act3').removeClass('current');
                $('#my_act2').removeClass('current');
                $('#my_act1').addClass('current');
                $('#tab-3').removeClass('current');
                $('#tab-2').removeClass('current');
                $('#tab-1').addClass('current');
                $('.content_column').scrollIntoView();
            }
        });

        // 프로필 이미지 미리보기

        var sel_file;
        $(document).ready(function (){
            $("#user_image_upload").on("change", handleImgFileSelect);
        });

        function handleImgFileSelect(e){
            var files = e.target.files;
            var filesArr = Array.prototype.slice.call(files);

            filesArr.forEach(function(f){
                if(!f.type.match("image.*")) {
                    alert("이미지만 업로드가 가능합니다.");
                    return;
                }

                sel_file = f;

                var reader = new FileReader();
                reader.onload = function(e){
                    $("#img").attr("src", e.target.result);
                }
                reader.readAsDataURL(f);
            });
        };

        // 배경화면 이미지 미리보기

        var back_file;
        $(document).ready(function (){
            $("#background").on("change", handleImgFileSelect2);
        });

        function handleImgFileSelect2(p){
            var files = p.target.files;
            var filesArr = Array.prototype.slice.call(files);

            filesArr.forEach(function(c){
                if(!c.type.match("image.*")) {
                    alert("이미지만 업로드가 가능합니다.");
                    return;
                }

                back_file = c;

                var reader = new FileReader();
                reader.onload = function(p){
                    <!--$("#myinfo_edit_mode").attr("style","background-image:url('/"+p.target.result+"')");-->
                    var imageUrl = p.target.result
                    $('#myinfo_edit_mode').css('background-image', 'url(' + imageUrl + ')');

                }
                reader.readAsDataURL(c);
            });
        };

        <!--$('#callmorepost').click(function(){-->
            <!--var page = $("#page").val();-->
            <!--var end_page = {{ articles.paginator.num_pages }};-->
            <!--console.log(end_page);-->
            <!--if(page > end_page) {-->
                <!--return;-->
            <!--}-->
            <!--callMorePostAjax(page);-->
            <!--$("#page").val(parseInt(page)+1);-->
        <!--});-->

        <!--function callMorePostAjax(page) {-->
            <!--var end_page = {{ articles.paginator.num_pages }};-->
            <!--if(page > end_page) {-->
                <!--return;-->
            <!--}-->

            <!--$.ajax({-->
                <!--type : "POST",-->
                <!--url : "../paginator_for_articles/",-->
                <!--data : {-->
                    <!--"page" : page,-->
                    <!--"csrfmiddlewaretoken" : "{{ csrf_token }}"-->
                <!--},-->
                <!--success : addMoreArticlesAjax,-->
                <!--dataType : "html",-->
                <!--error : function(request, status, error){-->
                    <!--alert('오류발생');-->
                <!--},-->
            <!--});-->
        <!--}-->

        <!--function addMoreArticlesAjax(data, textStatus, jqXHR) {-->
            <!--$(".popular-row").append(data);-->
        <!--}-->
    });
    /* var kk = "{{ replies }}" ;
    console.log(kk); */





      google.charts.load('current', {'packages':['corechart']});
      google.charts.setOnLoadCallback(drawVisualization);

      function drawVisualization() {
        // Some raw data (not necessarily accurate)
        var data = google.visualization.arrayToDataTable([
          ['Month', '정보공유보상', '보팅보상', '콘텐츠판매', '콘텐츠구매', 'Average'],
          ['Jan',  {{ Article_data_for_Jan }},      {{ numbersOfLike }},         {{ numbersOfsell }},             {{ numbersOfbuy }},      6],
          ['Feb',  {{ Article_data_for_Fed }},      {{ numbersOfLike }},        {{ numbersOfsell }},             {{ numbersOfbuy }},      8],
          ['Mar',  {{ Article_data_for_Mar }},      {{ numbersOfLike }},        {{ numbersOfsell }},             {{ numbersOfbuy }},      6],
          ['Apr',  {{ Article_data_for_Apr }},      {{ numbersOfLike }},        {{ numbersOfsell }},             {{ numbersOfbuy }},      4],
          ['May',  {{ Article_data_for_May }},      {{ numbersOfLike }},         {{ numbersOfsell }},             {{ numbersOfbuy }},      5]
        ]);

        var options = {
          title : '월별 개인 사용 내역(통합)',
          titlePosition: 'none',
          'legend' : 'center',
          vAxis: {title: '니드토큰 '},
          hAxis: {title: '월'},
          seriesType: 'bars',
          series: {6: {type: 'line'}},
          'width':900,
          'height':500,
        };



        var chart = new google.visualization.ComboChart(document.getElementById('chart_div'));
        chart.draw(data, options);
      }
</script>
</html>
{% endblock %}